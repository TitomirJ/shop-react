import categories from 'api/mockCategories'
import { db, storage } from 'config/firebase'

export const fetchPhonesApi = async () => {
    const dbRef = await db.collection('phones').get();
    return dbRef.docs.map(doc => doc.data());
};

export const fetchMorePhonesApi = async ({offset}) => {
    const dbRef = await db.collection('phones').get();
    return dbRef.docs.map(doc => doc.data());
};

export const fetchPhoneByIdApi = async (id) => {
    const dbRef = await db.collection('phones').get();
    const phones = dbRef.docs.map(doc => doc.data());
    return phones.find(item => item.id === id);
};

export const fetchCategoriesApi = async () => {
    return new Promise((resolve, reject) => {
        resolve(categories)
    })
};

export const editPhoneByIdApi = async (id, data = {}) => {
    db.collection('phones').doc(id).update(data)
};

export const addPhoneApi = async (data = {}, id) => {
    db.collection('phones').doc(`${id}`).set(data)
};

export const deletePhoneApi = async (id) => {
    db.collection('phones').doc(id).delete()
};

export const uploadFileApi = (pic) => async dispatch => {
    storage.ref("images/" + pic.name).put(pic).then(snapshot => {
        return snapshot.ref.getDownloadURL();
    });
};
